"use strict";(self.webpackChunkmini_books=self.webpackChunkmini_books||[]).push([[143],{"styles/main.css":(n,t,e)=>{e.r(t),e.d(t,{default:()=>s});var i=e(81),o=e.n(i),r=e(645),a=e.n(r)()(o());a.push([n.id,"@import url(https://fonts.googleapis.com/css2?family=Roboto&family=Varela+Round&family=Nunito&display=swap);"]),a.push([n.id,"/* @font-face {\n    font-family: ProductSans;\n    src: url(Product_Sans_Regular.ttf);\n}\n\n* {\n    font-family: ProductSans\n} */\n:root {\n    --primary: rgb(94, 141, 229);\n    --red: hsl(0, 100%, 95%);\n}\n\n* {\n    margin: 0;\n    padding: 0;\n    box-sizing: border-box;\n}\n\nhtml {\n    /* font-family: 'Roboto', sans-serif; */\n    font-family: 'Nunito', sans-serif;\n    /* font-family: 'Varela Round', sans-serif; */\n}\n\nbody {\n    padding: 8px;\n}\n\n.new {\n    display: inline-block;\n    text-decoration: none;\n    color: black;\n    padding: 4px;\n    border-radius: 4px;\n    border: 2px solid rgb(0, 128, 0);\n    background-color: rgb(0, 128, 0, 0.5);\n}\n\n.hd {\n    display: flex;\n    /* border: 1px dashed lightgray; */\n    align-items: baseline;\n    justify-content: space-between;\n    padding-block: 16px;\n}\n\n.hitle {\n    display: inline;\n    margin-right: auto;\n    white-space: nowrap;\n    text-overflow: ellipsis;\n    overflow:hidden;\n}\n\n.action {\n    display: inline;\n}\n\n.text-field {\n    display: inline-block;\n    height: 50px;\n    max-width: 400px;\n    min-width: 300px;\n    font-size: 20px;\n    border: none;\n    border-bottom: 1px solid lightgray;\n}\n\n.text-field:focus {\n    outline: none;\n    border-color: 1px solid blue;\n}\n.title-text-field,\n.title-text-field:disabled {\n    padding: 0;\n    margin: 0;\n    display: block;\n    font-size: 50px;\n    border: none;\n    border-bottom: 1px solid lightgray;\n    outline: none;\n    color: black;\n    background-color: white;\n    /* margin-inline: auto; */\n}\n\n.description-text-field,\n.description-text-field:disabled {\n    padding: 0;\n    margin: 0;\n    display: block;\n    font-size: 20px;\n    border: none;\n    outline: none;\n    margin-top: 16px;\n    color: hsl(0, 0%, 20%);\n    background-color: white;\n}\n\n.main-form {\n    display: flex;\n    max-width: 1000px;\n    margin-inline: auto;\n    flex-direction:column;\n    align-content: center;\n}\n\na {\n    text-decoration: none;\n    color: black;\n}\n\na:hover,\na:focus,\na:visited {\n    color: black\n}\n\n.floating-action-button {\n    position: sticky;\n    bottom: 16px;\n    float: right;\n    box-shadow: 0px 3px 3px lightgrey;\n}\n\ntextarea {\n    resize: none; \n}\n\ntextarea,\ninput[type=\"text\"] {\n    font-family: inherit;\n}\n\nbutton,\n.button {\n    font-family: inherit;\n    background-color: white;\n    border: 1px solid hsl(0, 0%, 83%);\n    padding: 16px;\n    max-height: 64px;\n    font-size: 20px;\n    border-radius: 16px;\n}\n\n.back {\n    display: inline;\n}\n\n.hidden {\n    visibility:hidden;\n}\n\n.action-buttons {\n    display: flex;\n    gap: 8px;\n    justify-content: flex-start;\n}\n.with-space-right {\n    margin-right: auto;\n}\n.with-space-left {\n    margin-left: auto;\n}\n\n.delete:hover {\n    background-color: var(--red);\n}\n\n.submit:hover {\n    background-color: hsl(120, 73%, 95%);\n}\n\nbutton:hover,\nbutton:focus,\na.button:hover,\na.button:focus {\n    cursor: pointer;\n    background-color: hsl(0, 0%, 99%);\n}\n\n.book-name {\n    text-align: center;\n    display: block;\n    font-size: 24px;\n    margin-right: auto;\n    border-bottom: 1px solid whitesmoke;\n}\n\n.book-description {\n    display: inline;\n    margin-top: 8px;\n    display: block;\n    color: grey;\n    margin-right: auto;\n}\n\n.book-list {\n    max-width: 1200px;\n    display: grid;\n    gap: 16px;\n    margin-inline: auto;\n    /* border: 1px solid lightgray; */\n}\n\n.book-list a {\n    border: 1px solid lightgray;\n    border-radius: 8px;\n    padding: 8px;\n}\n\n.book-list a:hover,\n.book-list a:focus {\n    background-color: hsl(0, 0%, 99%)\n}\n\n.chapter-item {\n    display: flex;\n    /* justify-content: space-between; */\n    align-items: center;\n    padding: 8px;\n    border: 1px solid lightgrey;\n    border-radius: 8px;\n    font-size: 24px;\n    margin-top: 16px;\n}\n\n.chapter {\n    margin-top: 16px;\n    display: flex;\n    align-items: center;\n    gap: 8px;\n}\n\n.main-chapter {\n    padding: 8px;\n    border: 1px solid lightgrey;\n    border-radius: 8px;\n    font-size: 24px;\n    white-space: nowrap;\n    text-overflow: ellipsis;\n}\n\n.material-symbols-outlined {\n    border-radius: 4px;\n    padding: 4px;\n    cursor:default;\n    /* font-variation-settings:\n    'FILL' 0,\n    'wght' 400,\n    'GRAD' 0,\n    'opsz' 48; */\n}\n\n.material-symbols-outlined:hover, \n.material-symbols-outlined:focus {\n    background-color: whitesmoke;\n}\n.material-symbols-outlined:hover.delete:hover {\n    background-color: var(--red);\n}\n\n\n/* // Small devices (landscape phones, 576px and up) */\n@media (max-width: 480px) {\n    .hitle { \n        display: none;\n    }\n    .hd {\n        justify-content: none;\n    }\n    .text-field {\n        flex-grow: 1;\n        min-width: 100px;\n    }\n}\n@media (min-width: 576px) { \n    .book-list {\n        justify-content: stretch;\n        grid-template-columns: repeat(1, 1fr);\n    }\n}\n\n/* // Medium devices (tablets, 768px and up) */\n@media (min-width: 768px) { \n    .book-list {\n        grid-template-columns: repeat(2, 1fr);\n    }\n    /* .text-field { \n        display: inline-block;\n    } */\n}\n\n/* // Large devices (desktops, 992px and up) */\n@media (min-width: 992px) { \n    .book-list {\n        grid-template-columns: repeat(3, 1fr);\n    }\n    /* .text-field { \n        display: inline-block;\n    } */\n}\n\n/* // Extra large devices (large desktops, 1200px and up) */\n@media (min-width: 1200px) { \n    .book-list {\n        grid-template-columns: repeat(4, 1fr);\n    }\n    /* .text-field { \n        display: inline-block;\n    } */\n}",""]);const s=a},"app.html":(n,t,e)=>{e.r(t),e.d(t,{default:()=>i});const i='<template>\n  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0" />\n  \n  <require from="./styles/main.css"></require>\n\n  <div style="margin-inline: auto; max-width: 1200px; position: relative;">\n    <router-view></router-view>\n  </div>\n</template>\n'},"common/my-header/my-header.html":(n,t,e)=>{e.r(t),e.d(t,{default:()=>i});const i='<template>\n    <header class="hd">\n        <button class="back ${back == \'hidden\' ? \'hidden\' : \'\'}" click.trigger="navigateBack()">Back</button>\n        <div style="width: 16px"></div>\n        <h1 class="hitle">${title}</h1>\n        <div repeat.for="action of actions" class="action">\n            ${action}\n        </div>\n        <slot name="actions"></slot>\n    </header>\n</template>'},"features/books/presentation/book/book-view.html":(n,t,e)=>{e.r(t),e.d(t,{default:()=>i});const i='<template>\n  <require from="../../../../common/my-header/my-header"></require>\n  <require from="../../../../common/html-txt"></require>\n  <require from="../../../../common/len"></require>\n\n  <my-header title="BOOK PAGE">\n    <div if.bind="isEdit" slot="actions">\n      <button click.trigger="submit()" class="submit">${submitText}</button>\n      <button click.trigger="deleteThisBook()" class="delete">Delete</button>\n    </div>\n    <div else slot="actions">\n      <button click.trigger="changeViewMode()" class="with-space-right">Edit</button>\n    </div>\n  </my-header>\n\n  <div class="main-form">\n    <input \n      class="title-text-field"\n      disabled.bind="!isEdit"\n      type="text" \n      value.bind="book.name" \n      placeholder="book name">\n    \x3c!-- <textarea \n      class="description-text-field"\n      disabled.bind="!isEdit"\n      role="textbox"\n      placeholder="book description" \n      value.bind="book.description | htmlTxt">\n    </textarea> --\x3e\n    <div if.bind="isEdit">\n      <div\n        contenteditable="true"\n        class="description-text-field"\n        aria-multiline="true"\n        role="textbox"\n        innerhtml.bind="book.description"\n      ></div>\n    </div>\n    <div else>\n      <div\n        contenteditable="false"\n        class="description-text-field"\n        aria-multiline="true"\n        role="textbox"\n        innerhtml.bind="book.description"\n      ></div>\n    </div>\n  </div>\n  \n  <div style="max-width: 1000px; margin-inline: auto;">\n    <h2 style=\'margin-top: 16px;\'>Chapters</h2>\n    <section>\n      <span repeat.for="chapter of book.chapters">\n        <article class="chapter">\n          <a class="main-chapter" route-href="route: chapterView; params.bind: {bid: book._id, cid: chapter._id};" style="flex-grow: 1;">\n            ${chapter.name}\n          </a>\n          <span if.bind="isEdit" click.trigger="deleteChapter(chapter)" class="material-symbols-outlined delete">delete_forever</span>\n        </article>\n      </span>\n    </section>\n    <div style="height: 33px"></div>\n    <a \n      route-href="route: chpaterAddView; params.bind: {bid: book._id};" \n      css="display: ${isEdit && isNewBook ? \'inherit\' : \'none\'};"\n      class="button floating-action-button">\n      Add New Chapter\n    </a>\n  </div>\n\n</template>'},"features/books/presentation/books/book-list.html":(n,t,e)=>{e.r(t),e.d(t,{default:()=>i});const i='<template>\n  <require from="../../../../common/my-header/my-header"></require>\n\n  <my-header title="BOOK LIST" back="hidden">\n    <div slot="actions">\n      <input \n        type="text" \n        input.trigger="refreshBooks($event.target.value) & debounce:300" \n        placeholder="type here" \n        class="text-field hitem">\n    </div>\n  </my-header>\n\n  <section class="book-list">\n    <a \n      repeat.for="book of books" \n      route-href="route: bookView; params.bind: {bid:book._id};"> \x3c!--, \'is-edit\': false--\x3e\n      <span class="book-name">${book.name}</span>\n      <div class="book-description" innerhtml.bind="book.description"></div>\n    </a>\n  </section>\n  \n  <button click.trigger="showAddNewPage()" class="floating-action-button" style="margin-bottom: 16px;">Add New</button>\n\n\n</template>'},"features/chapters/presentation/chapter-view.html":(n,t,e)=>{e.r(t),e.d(t,{default:()=>i});const i='<template>\n  <require from="../../../common/my-header/my-header"></require>\n  <my-header title="CHAPTER PAGE">\n    <div slot="actions">\n      <button if.bind="isEdit" click.trigger="submit()" class="submit">${submitText}</button>\n      <button if.bind="isEdit && isNewChapter" click.trigger="deleteThisChapter()" class="delete">Delete</button>\n      <button if.bind="!isEdit" click.trigger="changeViewMode()" class="with-space-right">Edit</button>\n    </div>\n  </my-header>\n\n  <article class="main-form">\n    <input \n      class="title-text-field"\n      disabled.bind="!isEdit"\n      type="text" \n      value.bind="chapter.name" \n      placeholder="chapter name">\n    \x3c!-- <textarea \n      class="description-text-field"\n      disabled.bind="!isEdit"\n      role="textbox"\n      placeholder="book description" \n      value.bind="book.description | htmlTxt">\n    </textarea> --\x3e\n\n    <div if.bind="isEdit">\n      <div\n        contenteditable="true"\n        class="description-text-field"\n        aria-multiline="true"\n        role="textbox"\n        innerhtml.bind="chapter.text"\n      ></div>\n    </div>\n\n    <div else>\n      <div\n        contenteditable="false"\n        class="description-text-field"\n        aria-multiline="true"\n        role="textbox"\n        innerhtml.bind="chapter.text"\n      ></div>\n    </div>\n  </article>\n  <div style="height: 50vh"></div>\n\n</template>'},app:(n,t,e)=>{e.r(t),e.d(t,{App:()=>i}),e("aurelia-framework");var i=function(){function n(){}return n.prototype.configureRouter=function(n,t){n.title="The App)",n.options.pushState=!0,n.options.root="/",n.map([{route:"",name:"home",moduleId:"./features/books/presentation/books/book-list",nav:!0,title:"BOOKS"},{route:"books/:bid",name:"bookView",moduleId:"./features/books/presentation/book/book-view",title:"BOOK"},{route:"books/add",name:"bookAddView",moduleId:"./features/books/presentation/book/book-view",title:"ADD BOOK"},{route:"books/:bid/chapters/:cid",name:"chapterView",moduleId:"./features/chapters/presentation/chapter-view",title:"EDIT CHAPTER"},{route:"books/:bid/chapters/add",name:"chpaterAddView",moduleId:"./features/chapters/presentation/chapter-view",title:"ADD CHAPTER"}]),this.router=t},n}()},"common/html-txt":(n,t,e)=>{e.r(t),e.d(t,{HtmlTxtValueConverter:()=>i});var i=function(){function n(){}return n.prototype.fromView=function(n){return n.replace(/<div>|<br>/,"\n").replace(/<\/div>/,"").replace(/&nbsp;/," ")},n.prototype.toView=function(n){return n},n}()},"common/len":(n,t,e)=>{e.r(t),e.d(t,{LenValueConverter:()=>i});var i=function(){function n(){}return n.prototype.fromView=function(n,t){return n.length>t?n.substring(0,t-1):n},n.prototype.toView=function(n,t){return n.length>t?n.substring(0,t-1):n},n}()},"common/my-header/my-header":(n,t,e)=>{e.r(t),e.d(t,{MyHeader:()=>a});var i=e(655),o=e("aurelia-framework"),r=e(470),a=function(){function n(n){this.router=n,this.back="shown"}return n.prototype.attached=function(){console.log("back: ".concat(this.back," type: ").concat(typeof this.back))},n.prototype.navigateBack=function(){this.router.navigateBack()},(0,i.gn)([o.bindable,(0,i.w6)("design:type",String)],n.prototype,"title",void 0),(0,i.gn)([o.bindable,(0,i.w6)("design:type",String)],n.prototype,"back",void 0),(0,i.gn)([o.autoinject,(0,i.w6)("design:paramtypes",[r.F0])],n)}()},585:(n,t,e)=>{e.d(t,{Z:()=>a});var i=e(655),o=e(956),r=e("aurelia-framework");const a=function(){function n(n){this.client=n}return n.prototype.fetchBooks=function(n){return void 0===n&&(n={limit:666,filter:""}),(0,i.mG)(this,void 0,void 0,(function(){var t,e;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:return t={query:"\n        query {\n          books(\n            limit: ".concat(n.limit,', \n            filter: "').concat(n.filter,'"\n          ) {\n            _id\n            name\n            description\n          }\n        }\n      ')},[4,this.client.fetch("graphql",{method:"POST",body:JSON.stringify(t)})];case 1:return[4,i.sent().json()];case 2:if((e=i.sent()).errors)throw e.errors;return[2,e.data.books]}}))}))},n.prototype.fetchBook=function(n){return(0,i.mG)(this,void 0,void 0,(function(){var t,e;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:return t={query:'\n        query {\n          book(id: "'.concat(n,'") {\n            _id\n            name\n            description\n            chapters {\n              _id\n              name\n            }\n          }\n        }\n      ')},console.log("fetchBook"),[4,this.client.fetch("graphql",{method:"POST",body:JSON.stringify(t)})];case 1:return[4,i.sent().json()];case 2:return e=i.sent(),console.log(e),[2,e.data.book]}}))}))},n.prototype.addBook=function(n){return(0,i.mG)(this,void 0,void 0,(function(){var t;return(0,i.Jh)(this,(function(e){switch(e.label){case 0:return t={query:'\n        mutation {\n          createBook(name: "'.concat(n.name,'", description: "').concat(n.description,'") {\n            name,\n            description\n          }\n        }\n      ')},[4,this.client.fetch("graphql",{method:"POST",body:JSON.stringify(t)})];case 1:return[4,e.sent().json()];case 2:return[2,e.sent().data.createBook]}}))}))},n.prototype.updateBook=function(n){return(0,i.mG)(this,void 0,void 0,(function(){var t;return(0,i.Jh)(this,(function(e){switch(e.label){case 0:return t={query:'\n        mutation {\n          updateBook(\n            book: {\n              _id: "'.concat(n._id,'",\n              name: "').concat(n.name,'",\n              description: """').concat(n.description,'""",\n              chapters: [\n                ').concat(n.chapters.map((function(n){return"{ \n                  ".concat(n._id?'_id: "'.concat(n._id,'",'):"",' \n                  name: "').concat(n.name,'",\n                  # text: "').concat(n.text,'"\n                }')})),"\n              ]\n            }\n          ) {\n            _id name description \n            chapters {\n              _id name text  \n            }\n          }\n        }\n      ")},[4,this.client.fetch("graphql",{method:"post",body:JSON.stringify(t)})];case 1:return[4,e.sent().json()];case 2:return[2,e.sent().data.updateBook]}}))}))},n.prototype.deleteBook=function(n){return(0,i.mG)(this,void 0,void 0,(function(){var t;return(0,i.Jh)(this,(function(e){switch(e.label){case 0:return t={query:'\n        mutation {\n          deleteBook(id: "'.concat(n,'")\n        }\n      ')},[4,this.client.fetch("graphql",{method:"POST",body:JSON.stringify(t)})];case 1:return e.sent(),[2]}}))}))},(0,i.gn)([r.autoinject,(0,i.w6)("design:paramtypes",[o.eN])],n)}()},"features/books/presentation/book/book-view":(n,t,e)=>{e.r(t),e.d(t,{BookView:()=>d});var i=e(655),o=e(470),r=e("aurelia-framework"),a=function(n,t,e,i){void 0===n&&(n=""),void 0===t&&(t=""),void 0===e&&(e=""),void 0===i&&(i=[]),this._id=n,this.name=t,this.description=e,this.chapters=i},s=e(585),c=e(121),d=function(){function n(n,t,e){this.router=n,this.repo=t,this.chaptersRepo=e,this.isEdit=!0,this.book=new a}return Object.defineProperty(n.prototype,"submitText",{get:function(){return""==this.book._id?"Add":"Save"},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isNewBook",{get:function(){return!!this.book._id},enumerable:!1,configurable:!0}),n.prototype.activate=function(n,t,e){n.bid?(console.log("I want to edit/view an existing book..."),this.fetchBook(n.bid),this.isEdit=!1):(console.log("NOW I WANT TO ADD A NEW BOOK!"),this.isEdit=!0),console.log(e.options)},n.prototype.changeViewMode=function(){this.isEdit=!this.isEdit,console.log("description: ".concat(JSON.stringify(this.book)))},n.prototype.back=function(){this.router.navigateBack()},n.prototype.deleteChapter=function(n){return(0,i.mG)(this,void 0,void 0,(function(){return(0,i.Jh)(this,(function(t){switch(t.label){case 0:return confirm('Are sure you want to delete "'.concat(n.name,'" chapter?'))?[4,this.chaptersRepo.deleteChapter(n._id)]:[3,2];case 1:t.sent(),this.book.chapters.splice(this.book.chapters.indexOf(n),1),t.label=2;case 2:return[2]}}))}))},n.prototype.submit=function(){return(0,i.mG)(this,void 0,void 0,(function(){return(0,i.Jh)(this,(function(n){switch(n.label){case 0:return console.log(JSON.stringify(this.book)),this.book._id?[3,2]:[4,this.addThisBook()];case 1:return n.sent(),this.back(),[3,4];case 2:return[4,this.updateThisBook()];case 3:n.sent(),this.isEdit=!1,n.label=4;case 4:return[2]}}))}))},n.prototype.addThisBook=function(){return(0,i.mG)(this,void 0,void 0,(function(){return(0,i.Jh)(this,(function(n){switch(n.label){case 0:return[4,this.repo.addBook(this.book)];case 1:return n.sent(),[2]}}))}))},n.prototype.updateThisBook=function(){return(0,i.mG)(this,void 0,void 0,(function(){var n;return(0,i.Jh)(this,(function(t){switch(t.label){case 0:return n=this,[4,this.repo.updateBook(this.book)];case 1:return n.book=t.sent(),console.log("updating the book ".concat(this.book)),this.isEdit=!1,[2]}}))}))},n.prototype.fetchBook=function(n){return(0,i.mG)(this,void 0,void 0,(function(){var t;return(0,i.Jh)(this,(function(e){switch(e.label){case 0:return t=this,[4,this.repo.fetchBook(n)];case 1:return t.book=e.sent(),console.log(this.book),[2]}}))}))},n.prototype.deleteThisBook=function(){return(0,i.mG)(this,void 0,void 0,(function(){return(0,i.Jh)(this,(function(n){switch(n.label){case 0:return confirm("Are you sure you want to delete this book?")?[4,this.repo.deleteBook(this.book._id)]:[3,2];case 1:n.sent(),this.back(),n.label=2;case 2:return[2]}}))}))},n.prototype.showChapter=function(n){console.log(n),this.router.navigateToRoute("chapterView",{bid:this.book._id,cid:n._id})},(0,i.gn)([r.autoinject,(0,r.observable)({name:"book.description",changeHandler:"bookDescriptionChanged"}),(0,i.w6)("design:paramtypes",[o.F0,s.Z,c.Z])],n)}()},"features/books/presentation/books/book-list":(n,t,e)=>{e.r(t),e.d(t,{BookList:()=>c});var i=e(655),o=e("aurelia-framework"),r=e(470),a=e(585);const s=function(){function n(n){void 0===n&&(n=300),this.milliseconds=n,this.isRunning=!1}return n.prototype.debounce=function(n){var t=this;this.isRunning&&(clearInterval(this.timer),this.isRunning=!1),this.timer=setTimeout((function(){n(),t.isRunning=!1}),this.milliseconds),this.isRunning=!0},n}();var c=function(){function n(n,t){this.router=n,this.repo=t,this.title="BOOK LIST",this.books=[],this.filterDebouncer=new s(300),console.log("BookList.constructor"),this.filterDebouncer.debounce((function(){console.log("the end.")}))}return n.prototype.activate=function(){console.log("BookList.activate"),this.refreshBooks()},n.prototype.showAddNewPage=function(){this.router.navigateToRoute("bookAddView")},n.prototype.refreshBooks=function(n){return void 0===n&&(n=""),(0,i.mG)(this,void 0,void 0,(function(){var t;return(0,i.Jh)(this,(function(e){switch(e.label){case 0:return t=this,[4,this.repo.fetchBooks({filter:n,limit:666})];case 1:return t.books=e.sent(),[2]}}))}))},(0,i.gn)([o.autoinject,(0,i.w6)("design:paramtypes",[r.F0,a.Z])],n)}()},121:(n,t,e)=>{e.d(t,{Z:()=>a});var i=e(655),o=e(956),r=e("aurelia-framework");const a=function(){function n(n){this.client=n}return n.prototype.fetchChapter=function(n,t){return(0,i.mG)(this,void 0,void 0,(function(){var n;return(0,i.Jh)(this,(function(e){switch(e.label){case 0:return n={query:'\n        query { \n          chapter(id: "'.concat(t,'") { \n            _id \n            name \n            text \n          } \n        }\n      ')},[4,this.client.fetch("graphql",{method:"POST",body:JSON.stringify(n)})];case 1:return[4,e.sent().json()];case 2:return[2,e.sent().data.chapter]}}))}))},n.prototype.addChapter=function(n,t){return(0,i.mG)(this,void 0,void 0,(function(){var e;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:return e={query:'\n        mutation {\n          createChapter(\n            bid: "'.concat(n,'",\n            chapter: {\n              name: "').concat(t.name,'",\n              text: "').concat(t.text,'"\n            }\n          ) { _id name text }\n        }\n      ')},[4,this.client.fetch("graphql",{method:"POST",body:JSON.stringify(e)})];case 1:return[4,i.sent().json()];case 2:return[2,i.sent().data.addChapter]}}))}))},n.prototype.updateChapter=function(n){return(0,i.mG)(this,void 0,void 0,(function(){var t;return(0,i.Jh)(this,(function(e){switch(e.label){case 0:return t={query:'\n        mutation {\n          updateChapter(\n            chapter: {\n              _id: "'.concat(n._id,'",\n              name: "').concat(n.name,'",\n              text: "').concat(n.text,'"\n            }\n          ) {\n            _id\n            name\n            text\n          }\n        }\n      ')},[4,this.client.fetch("graphql",{method:"POST",body:JSON.stringify(t)})];case 1:return[4,e.sent().json()];case 2:return[2,e.sent().data.updateChapter]}}))}))},n.prototype.deleteChapter=function(n){return(0,i.mG)(this,void 0,void 0,(function(){var t;return(0,i.Jh)(this,(function(e){switch(e.label){case 0:return t={query:'\n        mutation {\n          deleteChapter(id: "'.concat(n,'")\n        }\n      ')},[4,this.client.fetch("graphql",{method:"POST",body:JSON.stringify(t)})];case 1:return e.sent(),[2]}}))}))},(0,i.gn)([r.autoinject,(0,i.w6)("design:paramtypes",[o.eN])],n)}()},"features/chapters/presentation/chapter-view":(n,t,e)=>{e.r(t),e.d(t,{ChapterView:()=>c});var i=e(655),o=e(470),r=e("aurelia-framework"),a=e(121),s=function(n,t,e){void 0===n&&(n=""),void 0===t&&(t=""),void 0===e&&(e=""),this._id=n,this.name=t,this.text=e},c=function(){function n(n,t){this.router=n,this.repo=t,this.isEdit=!1,this.chapter=new s}return Object.defineProperty(n.prototype,"submitText",{get:function(){return this.chapter._id?"Save":"Add"},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isNewChapter",{get:function(){return Boolean(this.chapter._id)},enumerable:!1,configurable:!0}),n.prototype.activate=function(n,t,e){this.bid=n.bid,n.cid?(console.log("chapter exists - i will edit or view this chapter"),this.cid=n.cid,this.fetchChapter(),this.isEdit=!1):(console.log("chapter does not exist - add this chapter"),this.isEdit=!0)},n.prototype.fetchChapter=function(){return(0,i.mG)(this,void 0,void 0,(function(){var n;return(0,i.Jh)(this,(function(t){switch(t.label){case 0:return[4,this.repo.fetchChapter(this.bid,this.cid)];case 1:return n=t.sent(),console.log("fetchChapter cid:".concat(this.cid," bid:").concat(this.bid," ").concat(JSON.stringify(n))),this.chapter=n,[2]}}))}))},n.prototype.submit=function(){return(0,i.mG)(this,void 0,void 0,(function(){return(0,i.Jh)(this,(function(n){switch(n.label){case 0:return this.chapter._id?[3,2]:[4,this.addThisChapter()];case 1:return n.sent(),this.router.navigateBack(),[3,4];case 2:return[4,this.updateThisChapter()];case 3:n.sent(),this.isEdit=!1,n.label=4;case 4:return[2]}}))}))},n.prototype.addThisChapter=function(){return(0,i.mG)(this,void 0,void 0,(function(){var n;return(0,i.Jh)(this,(function(t){switch(t.label){case 0:return[4,this.repo.addChapter(this.bid,this.chapter)];case 1:return n=t.sent(),this.chapter=n,[2]}}))}))},n.prototype.updateThisChapter=function(){return(0,i.mG)(this,void 0,void 0,(function(){var n;return(0,i.Jh)(this,(function(t){switch(t.label){case 0:return console.log(JSON.stringify(this.chapter)),[4,this.repo.updateChapter(this.chapter)];case 1:return n=t.sent(),this.chapter=n,[2]}}))}))},n.prototype.deleteThisChapter=function(){return(0,i.mG)(this,void 0,void 0,(function(){return(0,i.Jh)(this,(function(n){switch(n.label){case 0:return confirm("Are you sure you want to delete this chapter?")?[4,this.repo.deleteChapter(this.cid)]:[3,2];case 1:n.sent(),this.router.navigateBack(),n.label=2;case 2:return[2]}}))}))},n.prototype.changeViewMode=function(){this.isEdit=!this.isEdit},(0,i.gn)([r.autoinject,(0,i.w6)("design:paramtypes",[o.F0,a.Z])],n)}()},main:(n,t,e)=>{e.d(t,{configure:()=>o});const i=JSON.parse('{"f":false,"K":false}');function o(n){n.use.standardConfiguration().feature("resources/index"),n.use.developmentLogging(i.f?"debug":"warn"),i.K&&n.use.plugin("aurelia-testing"),n.start().then((function(){return n.setRoot("app")}))}e(15)},"resources/index":(n,t,e)=>{e.r(t),e.d(t,{configure:()=>o});var i=e(956);function o(n){n.container.registerSingleton(i.eN,(function(){return(new i.eN).configure((function(n){n.baseUrl="http://192.168.0.142:5000/"}))}))}}},n=>{var t=t=>n(n.s=t);n.O(0,[2,195,566,958,981,449],(()=>(t(639),t(231),t(62)))),n.O()}]);